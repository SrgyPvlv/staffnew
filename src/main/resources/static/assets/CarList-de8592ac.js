import{C as a}from"./CarsDataService-4b8770b7.js";import{_ as m,e as p,r as C,o,c as i,a as e,w as f,b as v,v as b,F as h,f as g,h as u,t as c,i as y,j as B,g as N,n as k}from"./index-2226a9a9.js";const M={name:"cars-list",data(){return{cars:[],currentCar:null,currentIndex:-1,filter:""}},computed:{currentUser(){return this.$store.state.auth.user},showAdminBoard(){return this.currentUser&&this.currentUser.roles?this.currentUser.roles.includes("ROLE_ADMIN"):!1},showSuperAdminBoard(){return this.currentUser&&this.currentUser.roles?this.currentUser.roles.includes("ROLE_SUPERADMIN"):!1}},methods:{retrieveCars(){a.getAll().then(t=>{this.cars=t.data,console.log(t.data)}).catch(t=>{console.log(t)})},deleteCar(){a.delete(this.currentCar.id).then(t=>{console.log(t.data),this.refreshList()},t=>{t.response&&t.response.status===410&&p.dispatch("logout"),t.response&&t.response.status===404&&alert(`Ошибка!
Что-то пошло не так!
Возможно Вы пытаетесь удалить автомобиль закрепленный за сотрудником!?`)}).catch(t=>{console.log(t)})},refreshList(){this.retrieveCars(),this.currentCar=null,this.currentIndex=-1,this.filter=""},setActiveCar(t,r){this.currentCar=t,this.currentIndex=t?r:-1},findByNumberModel(){a.findByNumberModel(this.filter).then(t=>{this.cars=t.data,this.currentCar=null,this.currentIndex=-1,console.log(t.data)}).catch(t=>{console.log(t)})}},mounted(){this.retrieveCars()}},x={class:"list row"},w={class:"col-md-6"},L={class:"input-group mb-3"},A={class:"input-group-append ms-3"},U={class:"input-group-append ms-3"},I={class:"list row"},S={class:"col-md-4"},D=e("h3",null," Список автомобилей ",-1),R={class:"col-md-12 outdiv shadow"},V={class:"col-md-12 indiv"},E={class:"list-group list-group-flush list-group-numbered"},F=["onClick"],O={class:"col-md-8"},P={key:0},T=e("h3",null," Автомобиль ",-1),j=e("label",null,[e("strong",null,"Номер:")],-1),z=e("label",null,[e("strong",null,"Модель:")],-1),q=e("label",null,[e("strong",null,"Водитель:")],-1),G=e("label",null,[e("strong",null,"Комментарий:")],-1),H={key:0},J={key:1},K=e("br",null,null,-1),Q=e("p",null,"Выберите машину...",-1),W=[K,Q];function X(t,r,Y,Z,s,l){const _=C("RouterLink");return o(),i(h,null,[e("div",x,[e("div",w,[e("form",{onSubmit:r[3]||(r[3]=f((...n)=>l.findByNumberModel&&l.findByNumberModel(...n),["prevent"]))},[e("div",L,[v(e("input",{type:"text",class:"form-control",placeholder:"Поиск по номеру, модели","onUpdate:modelValue":r[0]||(r[0]=n=>s.filter=n)},null,512),[[b,s.filter]]),e("div",A,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:r[1]||(r[1]=(...n)=>l.findByNumberModel&&l.findByNumberModel(...n))},"Поиск")]),e("div",U,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:r[2]||(r[2]=(...n)=>l.refreshList&&l.refreshList(...n))},"Сбросить")])])],32)])]),e("div",I,[e("div",S,[D,e("div",R,[e("div",V,[e("ul",E,[(o(!0),i(h,null,g(s.cars,(n,d)=>(o(),i("li",{class:k(["list-group-item car",{active:d==s.currentIndex}]),key:d,onClick:$=>l.setActiveCar(n,d)},c(n.carNumber),11,F))),128))])])])]),e("div",O,[s.currentCar?(o(),i("div",P,[T,e("div",null,[j,u(" "+c(s.currentCar.carNumber),1)]),e("div",null,[z,u(" "+c(s.currentCar.carModel!=null?s.currentCar.carModel.carModel:""),1)]),e("div",null,[q,u(" "+c(s.currentCar.employee!=null?s.currentCar.employee.name+", "+s.currentCar.employee.mobilePhone:""),1)]),e("div",null,[G,u(" "+c(s.currentCar.carComment),1)]),l.showAdminBoard||l.showSuperAdminBoard?(o(),i("div",H,[y(_,{to:"/cars/"+s.currentCar.id,class:"badge rounded-pill bg-info edit",style:{"margin-top":"15px"}},{default:B(()=>[u("Редактировать")]),_:1},8,["to"]),e("button",{onClick:r[4]||(r[4]=(...n)=>l.deleteCar&&l.deleteCar(...n)),class:"badge rounded-pill bg-danger ms-3 border-0 delete"},"Удалить")])):N("",!0)])):(o(),i("div",J,W))])])],64)}const se=m(M,[["render",X]]);export{se as default};
