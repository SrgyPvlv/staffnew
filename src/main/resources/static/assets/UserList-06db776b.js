import{k as i,_ as w,e as u,o as n,c as r,a,g as b,F as m,f as g,b as h,v,d as k,t as V}from"./index-2226a9a9.js";class y{get(s){return i.get(`/users/${s}`)}getAll(){return i.get("/users")}create(s){return i.post("/users",s)}update(s,c){return i.put(`/users/${s}`,c)}delete(s){return i.delete(`/users/${s}`)}}const p=new y;class D{getAll(){return i.get("/roles")}}const L=new D;const $={name:"users-list",data(){return{users:[],roles:[],submitted:!1}},computed:{currentUser(){return this.$store.state.auth.user},showAdminBoard(){return this.currentUser&&this.currentUser.roles?this.currentUser.roles.includes("ROLE_ADMIN"):!1}},methods:{retrieveUsers(){p.getAll().then(e=>{this.users=e.data,console.log(e.data)},e=>{e.response&&e.response.status===410&&u.dispatch("logout"),e.response&&e.response.status===404&&alert(`Ошибка!
Что-то пошло не так!
Не удалось загрузить список пользователей!`)}).catch(e=>{console.log(e)})},deleteUser(e){p.delete(e).then(s=>{console.log(s.data),this.refreshList()},s=>{s.response&&s.response.status===410&&u.dispatch("logout"),s.response&&s.response.status===404&&alert(`Ошибка!
Что-то пошло не так!
Не получилось удалить пользователя!`)}).catch(s=>{console.log(s)})},editUser(e,s,c,_){var d={username:s,password:c,role:_};p.update(e,d).then(t=>{console.log(t.data),this.refreshList(),this.submitted=!0},t=>{t.response&&t.response.status===410&&u.dispatch("logout"),t.response&&t.response.status===501&&alert("Ошибка! Что-то пошло не так!")}).catch(t=>{console.log(t)})},refreshList(){this.retrieveUsers(),this.submitted=!1},retrieveRoles(){L.getAll().then(e=>{this.roles=e.data,console.log(e.data)}).catch(e=>{console.log(e)})}},mounted(){this.retrieveUsers(),this.retrieveRoles()}},x={class:"list row"},A={class:"col-md-8"},S=a("h3",null," Список пользователей (admin) ",-1),B={key:0,class:"text-success"},C={class:"col-md-8 outdiv shadow mt-3"},R={class:"col-md-12 indiv"},q={class:"list-group list-group-flush"},M=["onUpdate:modelValue"],N=["onUpdate:modelValue"],E=["onUpdate:modelValue"],F=["value"],I=["onClick"],O=["onClick"];function T(e,s,c,_,d,t){return n(),r("div",x,[a("div",A,[S,d.submitted?(n(),r("p",B,"Данные успешно обновлены!")):b("",!0),a("div",C,[a("div",R,[a("ul",q,[(n(!0),r(m,null,g(d.users,(o,f)=>(n(),r("li",{class:"list-group-item car",key:f},[h(a("input",{class:"inputwidth mt-1","onUpdate:modelValue":l=>o.username=l,required:""},null,8,M),[[v,o.username]]),h(a("input",{type:"password",class:"inputwidth mt-1","onUpdate:modelValue":l=>o.password=l,required:""},null,8,N),[[v,o.password]]),h(a("select",{class:"form-select inputwidth mt-1","onUpdate:modelValue":l=>o.role=l,required:""},[(n(!0),r(m,null,g(d.roles,(l,U)=>(n(),r("option",{key:U,value:l},V(l.name),9,F))),128))],8,E),[[k,o.role]]),a("button",{onClick:l=>t.editUser(o.id,o.username,o.password,o.role),class:"badge rounded-pill bg-success mt-2 border-0 delete"},"Сохранить",8,I),a("button",{onClick:l=>t.deleteUser(o.id),class:"badge rounded-pill bg-danger ms-3 border-0 delete"},"Удалить",8,O)]))),128))])])])])])}const z=w($,[["render",T]]);export{z as default};
